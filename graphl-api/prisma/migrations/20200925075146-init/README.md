# Migration `20200925075146-init`

This migration has been generated by Sebastie, at 9/25/2020, 9:51:46 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "Subreddit" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "name" TEXT NOT NULL,
    "description" TEXT NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "count" INTEGER NOT NULL
)

CREATE TABLE "User" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "name" TEXT NOT NULL,
    "email" TEXT NOT NULL,
    "password" TEXT NOT NULL
)

CREATE TABLE "Post" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "content" TEXT NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "url" TEXT NOT NULL,
    "userId" INTEGER,
    "subredditId" INTEGER NOT NULL,

    FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE,
    FOREIGN KEY ("subredditId") REFERENCES "Subreddit"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE TABLE "Comment" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "content" TEXT NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "userId" INTEGER NOT NULL,
    "postId" INTEGER NOT NULL,

    FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY ("postId") REFERENCES "Post"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE TABLE "Reply" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "content" TEXT NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "userId" INTEGER NOT NULL,
    "commentId" INTEGER NOT NULL,

    FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY ("commentId") REFERENCES "Comment"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE TABLE "Upvote" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "postId" INTEGER NOT NULL,
    "userId" INTEGER NOT NULL,

    FOREIGN KEY ("postId") REFERENCES "Post"("id") ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE TABLE "_SubredditBookmarked" (
    "A" INTEGER NOT NULL,
    "B" INTEGER NOT NULL,

    FOREIGN KEY ("A") REFERENCES "Subreddit"("id") ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY ("B") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE UNIQUE INDEX "User.email_unique" ON "User"("email")

CREATE UNIQUE INDEX "Upvote.postId_userId_unique" ON "Upvote"("postId", "userId")

CREATE UNIQUE INDEX "_SubredditBookmarked_AB_unique" ON "_SubredditBookmarked"("A", "B")

CREATE INDEX "_SubredditBookmarked_B_index" ON "_SubredditBookmarked"("B")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200925075146-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,74 @@
+// Datasource
+datasource db {
+  provider = "sqlite"
+  url = "***"
+}
+
+// Prisma Client
+generator client {
+  provider = "prisma-client-js"
+}
+
+// Models
+model Subreddit {
+  id            Int       @id @default(autoincrement())
+  name          String
+  description   String
+  createdAt     DateTime  @default(now())
+  posts         Post[]
+  count         Int
+  bookmarkedBy  User[]    @relation("SubredditBookmarked", references: [id])  
+}
+
+model User {
+  id           Int            @id @default(autoincrement())
+  name         String
+  email        String         @unique
+  password     String
+  posts        Post[]
+  favSubreddits Subreddit[]   @relation("SubredditBookmarked", references: [id])
+  comments     Comment[]
+  replies      Reply[] 
+}
+
+model Post {
+  id          Int       @id @default(autoincrement())
+  content     String   
+  createdAt   DateTime  @default(now())
+  url         String
+  user        User?     @relation(fields: [userId], references: [id])
+  userId      Int?
+  upvotes     Upvote[]
+  comments    Comment[]
+  subreddit   Subreddit @relation(fields: [subredditId], references: [id])
+  subredditId Int
+}
+
+model Comment {
+  id          Int       @id @default(autoincrement())
+  content     String
+  createdAt   DateTime  @default(now())
+  user        User      @relation(fields: [userId], references: [id])
+  userId      Int
+  post        Post      @relation(fields: [postId], references: [id])
+  postId      Int
+}
+
+model Reply {
+  id          Int       @id @default(autoincrement())
+  content     String
+  createdAt   DateTime  @default(now())
+  user        User      @relation(fields: [userId], references: [id])
+  userId      Int
+  comment     Comment   @relation(fields: [commentId], references: [id])
+  commentId   Int
+}
+
+model Upvote {
+  id     Int  @id @default(autoincrement())
+  post   Post @relation(fields: [postId], references: [id])
+  postId Int
+  user   User @relation(fields: [userId], references: [id])
+  userId Int
+  @@unique([postId, userId])
+}
```


